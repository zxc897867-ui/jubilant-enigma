<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>房屋資訊自動生成器</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body { font-family: "微軟正黑體", Arial, sans-serif; margin: 30px; }
    label { display: block; margin: 8px 0 2px; }
    input[type="text"], select, textarea { box-sizing: border-box; }
    input[type="radio"], input[type="checkbox"] { width: auto; margin-right: 4px; vertical-align: middle; }
    .auto-grow { min-width: 120px; width: auto; max-width: 60vw; transition: width 0.2s; }
    .square-textarea { width: 200px; height: 200px; resize: both; font-size: 16px; box-sizing: border-box; display: block; }
    .small-input { width: 30px; text-align: center; }
    input[type="radio"]:checked, input[type="checkbox"]:checked { accent-color: orange; }
    textarea { margin-top: 10px; width: 100%; font-size: 18px; }
    button { margin: 10px 5px 0 0; padding: 8px 16px; }
    .row { display: flex; gap: 0; align-items: center; }
    .row label, .row input { flex: unset; }
    #date { width: 140px; max-width: 40vw; height: 36px; border-radius: 4px; font-size: 16px; padding: 4px 8px; margin-right: 10px; }
    #today_obj { width: 300px; max-width: 90vw; height: 36px; border-radius: 4px; font-size: 16px; padding: 4px 8px; }
    .tooltip { position: relative; display: inline-block; }
    .tip-link { color: #1976d2; text-decoration: underline; cursor: pointer; font-size: 15px; }
    .tip-content { display: none; position: absolute; left: 0; top: 24px; background: #222; color: #fff; padding: 10px 14px; border-radius: 6px; font-size: 15px; z-index: 99; min-width: 220px; max-width: 80vw; box-shadow: 0 2px 8px rgba(0,0,0,0.2); word-break: break-all; }
    .tooltip.show .tip-content { display: block; }
  </style>
</head>
<body>
  <h2>房屋資訊自動生成器</h2>
  <form id="houseForm" autocomplete="off">
    <!-- 日期 + 今日物件 -->
    <div class="row">
      <label style="min-width:50px;margin-right:4px;">日期</label>
      <input name="date" id="date" readonly>
      <span style="margin-right:4px;">今日物件</span>
      <input name="today_obj" id="today_obj" placeholder="可填寫" style="width:300px;max-width:90vw;">
    </div>
    <!-- 可否廣告 -->
    <label>可否廣告：
      <input type="radio" name="ad" value="可刊登">可刊登
      <input type="radio" name="ad" value="不可刊登591可刊登其他平台">不可刊登591可刊登其他平台
      <input type="radio" name="ad" value="不可刊登">不可刊登
    </label>
    <!-- 可否簽委托書 -->
    <label>可否簽委托書：
      <input type="radio" name="sign" value="可(已簽)">可(已簽)
      <input type="radio" name="sign" value="可(可補簽)">可(可補簽)
      <input type="radio" name="sign" value="不可(可上架廣告)">不可(可上架廣告)
      <input type="radio" name="sign" value="不可">不可
    </label>
    <!-- 頂加是否為民國84年前增建 -->
    <label>頂加是否為民國84年前增建：
      <input type="radio" name="top" value="是">是
      <input type="radio" name="top" value="否">否
    </label>
    <!-- 報稅 -->
    <label>報稅：
      <input type="radio" name="tax" value="可">可
      <input type="radio" name="tax" value="否">否
    </label>
    <!-- 租補 -->
    <label>租補：
      <input type="radio" name="subsidy" value="可">可
      <input type="radio" name="subsidy" value="否">否
      <input type="radio" name="subsidy" value="其他">其他
    </label>
    <!-- 入籍 -->
    <label>入籍：
      <input type="radio" name="register" value="可">可
      <input type="radio" name="register" value="否">否
      <input type="radio" name="register" value="其他">其他
    </label>
    <!-- 寵物 -->
    <label>寵物：
      <input type="radio" name="pet" value="否">否
      <input type="radio" name="pet" value="可">可
      <input type="radio" name="pet" value="可貓">可貓
      <input type="radio" name="pet" value="可狗">可狗
      <input type="radio" name="pet" value="其他">其他
    </label>
    <!-- 停車位 -->
    <label>停車位：
      <input type="radio" name="parking" value="有">有
      <input type="radio" name="parking" value="無">無
      <input type="radio" name="parking" value="其他">其他
    </label>
    <!-- 其餘欄位同你原本的表單 -->
    <label>
      地址
      <span class="tooltip">
        <a href="javascript:void(0);" class="tip-link" onclick="showTip(this)">說明</a>
        <span class="tip-content">詳細地址及樓層如為頂加特別註記</span>
      </span>
      ：<input name="address" class="auto-grow" required>
    </label>
    <label>
      總樓層
      <span class="tooltip">
        <a href="javascript:void(0);" class="tip-link" onclick="showTip(this)">說明</a>
        <span class="tip-content">所在樓層/總樓層數</span>
      </span>
      ：<input name="floor" class="auto-grow" required>
    </label>
    <label>
      建物型態
      <span class="tooltip">
        <a href="javascript:void(0);" class="tip-link" onclick="showTip(this)">說明</a>
        <span class="tip-content">前面為房間型態（分套、獨套、雅房）/後面為大樓的型態（公寓、電梯大樓、透天厝）</span>
      </span>
      ：<input name="type" class="auto-grow" required>
    </label>
    <label>
      坪數
      <span class="tooltip">
        <a href="javascript:void(0);" class="tip-link" onclick="showTip(this)">說明</a>
        <span class="tip-content">房內坪數（如為獨立套房/整層需調閱謄本） 頂加不用調</span>
      </span>
      ：<input name="area" class="auto-grow" required>
    </label>
    <label>
      格局
      <span class="tooltip">
        <a href="javascript:void(0);" class="tip-link" onclick="showTip(this)">說明</a>
        <span class="tip-content">請依現況格局如實填寫，若未如實填寫，後續若致生爭議，須自行負責！</span>
      </span>
      ：
      <input type="text" name="layout_room" class="small-input" maxlength="2" placeholder="房"> 房
      <input type="text" name="layout_living" class="small-input" maxlength="2" placeholder="廳"> 廳
      <input type="text" name="layout_bath" class="small-input" maxlength="2" placeholder="衛浴"> 衛浴
      <input type="text" name="layout_kitchen" class="small-input" maxlength="2" placeholder="廚房"> 廚房
      <input type="text" name="layout_balcony" class="small-input" maxlength="2" placeholder="陽台"> 陽台
      <label><input type="checkbox" name="layout_option" value="開放式">開放式</label>
      <label><input type="checkbox" name="layout_option" value="樓中樓">樓中樓</label>
    </label>
    <label>租金：<input name="rent" class="auto-grow" required></label>
    <label>
      管理費
      <span class="tooltip">
        <a href="javascript:void(0);" class="tip-link" onclick="showTip(this)">說明</a>
        <span class="tip-content">有無管理費用（若有請註記包含哪些費用ex:水費、瓦斯費、第四台費用、網路費用、垃圾代收)</span>
      </span>
      ：<input name="fee" class="auto-grow" required>
      <label style="display:inline;"><input type="radio" name="fee_none" value="無">無</label>
    </label>
    <label>底價：<input name="base" class="auto-grow" required></label>
    <label>
      公設
      <span class="tooltip">
        <a href="javascript:void(0);" class="tip-link" onclick="showTip(this)">說明</a>
        <span class="tip-content">有些分套可能會有飲水機等等，這些都可以註記，社區大樓有什麼樣的公設也可以註記 健身房 會議室 游泳池 桌球撞球室 KTV 花園等</span>
      </span>
      ：<input name="public" class="auto-grow" placeholder="請填寫公設內容">
    </label>
    <label>
      電費$/度
      <span class="tooltip">
        <a href="javascript:void(0);" class="tip-link" onclick="showTip(this)">說明</a>
        <span class="tip-content">電費一度費用為多少？夏季非夏季計費有無不同?若房東說帳單請標註：台電帳單</span>
      </span>
      ：<input name="electric" class="auto-grow" required>
    </label>
    <label>
      水費
      <span class="tooltip">
        <a href="javascript:void(0);" class="tip-link" onclick="showTip(this)">說明</a>
        <span class="tip-content">有無用水之費用，有的話金額為多少 超過多少度 收多少錢等等，若房東說帳單請標註：台水帳單</span>
      </span>
      ：<input name="water" class="auto-grow" required>
    </label>
    <label>
      瓦斯
      <span class="tooltip">
        <a href="javascript:void(0);" class="tip-link" onclick="showTip(this)">說明</a>
        <span class="tip-content">有無瓦斯爐（是否能開火、還是不能用明火，可用電磁爐，請另外標註天然瓦斯或是瓦斯桶，瓦斯桶不可勾天然瓦斯)</span>
      </span>
      ：<input name="gas" class="auto-grow" required>
    </label>
    <label>鄰近交通(站點/分鐘)：<input name="traffic" class="auto-grow" required></label>
    <label>帶看方式：<input name="show" class="auto-grow" required></label>
    <label>附加設備：<textarea name="equip" class="square-textarea" required></textarea></label>
    <label>注意事項(生活機能、東服等補充)：<textarea name="note" class="square-textarea" required></textarea></label>
    <label>開發：<input name="dev" class="auto-grow" required></label>
    <button type="button" onclick="generate()">產生格式</button>
    <button type="button" onclick="copyText()">複製內容</button>
  </form>
  <textarea id="output" readonly placeholder="這裡會自動產生格式內容" oninput="autoGrow(this)"></textarea>
  <script>
    // 手機友善說明提示
    function showTip(link) {
      document.querySelectorAll('.tooltip.show').forEach(function(tip){
        if (tip !== link.parentNode) tip.classList.remove('show');
      });
      link.parentNode.classList.toggle('show');
    }
    document.addEventListener('click', function(e){
      if (!e.target.classList.contains('tip-link')) {
        document.querySelectorAll('.tooltip.show').forEach(function(tip){
          tip.classList.remove('show');
        });
      }
    });

    // 顯示/隱藏備註欄
    function toggleRadioInput(radioName, yesId) {
      document.querySelectorAll(`input[name="${radioName}"]`).forEach(function(radio) {
        radio.addEventListener('change', function() {
          if (yesId) document.getElementById(yesId).style.display = (radio.value === "可" || radio.value === "有") && radio.checked ? 'inline-block' : 'none';
          if (yesId && document.getElementById(yesId).style.display === 'none') document.getElementById(yesId).value = '';
        });
      });
    }
    toggleRadioInput('tax', 'tax_yes_text');
    toggleRadioInput('subsidy', 'subsidy_yes_text');
    toggleRadioInput('register', 'register_yes_text');
    toggleRadioInput('parking', 'parking_yes_text');

    // 報稅其他複選備註
    const taxOtherCheckbox = document.getElementById('tax_other_checkbox');
    const taxOtherText = document.getElementById('tax_other_text');
    if (taxOtherCheckbox && taxOtherText) {
      taxOtherCheckbox.addEventListener('change', function() {
        if (taxOtherCheckbox.checked) {
          taxOtherText.style.display = 'inline-block';
          taxOtherText.focus();
        } else {
          taxOtherText.style.display = 'none';
          taxOtherText.value = '';
        }
      });
    }
    // 租補其他複選備註
    const subsidyOtherCheckbox = document.getElementById('subsidy_other_checkbox');
    const subsidyOtherText = document.getElementById('subsidy_other_text');
    if (subsidyOtherCheckbox && subsidyOtherText) {
      subsidyOtherCheckbox.addEventListener('change', function() {
        if (subsidyOtherCheckbox.checked) {
          subsidyOtherText.style.display = 'inline-block';
          subsidyOtherText.focus();
        } else {
          subsidyOtherText.style.display = 'none';
          subsidyOtherText.value = '';
        }
      });
    }
    // 入籍其他複選備註
    const registerOtherCheckbox = document.getElementById('register_other_checkbox');
    const registerOtherText = document.getElementById('register_other_text');
    if (registerOtherCheckbox && registerOtherText) {
      registerOtherCheckbox.addEventListener('change', function() {
        if (registerOtherCheckbox.checked) {
          registerOtherText.style.display = 'inline-block';
          registerOtherText.focus();
        } else {
          registerOtherText.style.display = 'none';
          registerOtherText.value = '';
        }
      });
    }
    // 寵物複選的其他
    const petOtherCheckbox = document.getElementById('pet_other_checkbox');
    const petOtherText = document.getElementById('pet_other_text');
    if (petOtherCheckbox && petOtherText) {
      petOtherCheckbox.addEventListener('change', function() {
        if (petOtherCheckbox.checked) {
          petOtherText.style.display = 'inline-block';
          petOtherText.focus();
          adjustInputWidth(petOtherText);
        } else {
          petOtherText.style.display = 'none';
          petOtherText.value = '';
        }
      });
    }

    // 讓所有 .auto-grow input 根據內容自動變長
    function adjustInputWidth(input) {
      let span = document.getElementById('width-tester');
      if (!span) {
        span = document.createElement('span');
        span.id = 'width-tester';
        span.style.visibility = 'hidden';
        span.style.position = 'absolute';
        span.style.whiteSpace = 'pre';
        span.style.font = window.getComputedStyle(input).font;
        document.body.appendChild(span);
      }
      span.textContent = input.value || input.placeholder || '';
      input.style.width = Math.max(120, span.offsetWidth + 20) + 'px';
    }
    document.querySelectorAll('.auto-grow').forEach(function(input) {
      input.addEventListener('input', function() {
        adjustInputWidth(this);
      });
      adjustInputWidth(input);
    });
    document.querySelectorAll('input[type="text"]').forEach(function(input) {
      input.addEventListener('input', function() {
        adjustInputWidth(this);
      });
    });

    // 讓產生格式的 textarea 自動變高
    function autoGrow(element) {
      element.style.height = "5px";
      element.style.height = (element.scrollHeight) + "px";
    }

    // 格局產生格式（只顯示有填寫的）
    function getLayoutValue() {
      const items = [];
      const room = document.querySelector('input[name="layout_room"]').value;
      const living = document.querySelector('input[name="layout_living"]').value;
      const bath = document.querySelector('input[name="layout_bath"]').value;
      const kitchen = document.querySelector('input[name="layout_kitchen"]').value;
      const balcony = document.querySelector('input[name="layout_balcony"]').value;
      if (room) items.push(`房${room}`);
      if (living) items.push(`廳${living}`);
      if (bath) items.push(`衛浴${bath}`);
      if (kitchen) items.push(`廚房${kitchen}`);
      if (balcony) items.push(`陽台${balcony}`);
      let options = [];
      document.querySelectorAll('input[name="layout_option"]:checked').forEach(function(cb) {
        options.push(cb.value);
      });
      if (options.length) items.push(options.join('、'));
      return items.join(' ');
    }

    // 報稅產生格式
    function getTaxValue() {
      const checked = document.querySelector('input[name="tax"]:checked');
      let arr = [];
      if (checked) {
        arr.push(checked.value);
      }
      const taxOther = document.getElementById('tax_other_checkbox');
      if (taxOther && taxOther.checked) {
        arr.push('其他');
      }
      return arr.join('、');
    }

    // 租補產生格式
    function getSubsidyValue() {
      const checked = document.querySelector('input[name="subsidy"]:checked');
      let arr = [];
      if (checked) {
        arr.push(checked.value);
      }
      const subsidyOther = document.getElementById('subsidy_other_checkbox');
      if (subsidyOther && subsidyOther.checked) {
        arr.push('其他');
      }
      return arr.join('、');
    }

    // 入籍產生格式
    function getRegisterValue() {
      const checked = document.querySelector('input[name="register"]:checked');
      let arr = [];
      if (checked) {
        arr.push(checked.value);
      }
      const registerOther = document.getElementById('register_other_checkbox');
      if (registerOther && registerOther.checked) {
        arr.push('其他');
      }
      return arr.join('、');
    }

    // 停車位產生格式
    function getParkingValue() {
      const checked = document.querySelector('input[name="parking"]:checked');
      let arr = [];
      if (checked) {
        arr.push(checked.value);
      }
      document.querySelectorAll('input[name="parking_other"]:checked').forEach(function(cb) {
        arr.push(cb.value);
      });
      return arr.join('、');
    }

    // 取得寵物複選值
    function getPetValue() {
      let arr = [];
      document.querySelectorAll('input[name="pet"]:checked').forEach(function(cb) {
        arr.push(cb.value);
      });
      return arr.join('、');
    }

    // 產生格式內容
    function generate() {
      const data = new FormData(document.getElementById('houseForm'));
      let output =
        `日期：${data.get('date')} 今日物件：${data.get('today_obj')}\n\n` +
        `可否廣告：${data.get('ad')}\n\n` +
        `可否簽委托書：${data.get('sign')}\n\n` +
        `地址：${data.get('address')}\n\n` +
        `頂加是否為民國84年前增建：${data.get('top')}\n\n` +
        `房號：${data.get('room')}${data.get('room_none') ? '（無）' : ''}\n\n` +
        `總樓層：${data.get('floor')}\n\n` +
        `建物型態：${data.get('type')}\n\n` +
        `坪數：${data.get('area')}\n\n` +
        `格局：${getLayoutValue()}\n\n` +
        `租金：${data.get('rent')}\n\n` +
        `管理費：${data.get('fee')}${data.get('fee_none') ? '（無）' : ''}\n\n` +
        `底價：${data.get('base')}\n\n` +
        `報稅：${getTaxValue()}\n\n` +
        `租補：${getSubsidyValue()}\n\n` +
        `入籍：${getRegisterValue()}\n\n` +
        `寵物：${getPetValue()}\n\n` +
        `垃圾代收：${data.get('garbage')}\n\n` +
        `停車位：${getParkingValue()}\n\n` +
        `公設：${data.get('public')}\n\n` +
        `電費$/度：${data.get('electric')}\n\n` +
        `水費：${data.get('water')}\n\n` +
        `瓦斯：${data.get('gas')}\n\n` +
        `鄰近交通(站點/分鐘)：${data.get('traffic')}\n\n` +
        `帶看方式：${data.get('show')}\n\n` +
        `附加設備：${data.get('equip')}\n\n` +
        `注意事項(生活機能、東服等補充)：${data.get('note')}\n\n` +
        `開發：${data.get('dev')}`;
      document.getElementById('output').value = output;
      autoGrow(document.getElementById('output'));
    }

    // 複製內容到剪貼簿
    function copyText() {
      const output = document.getElementById('output');
      output.select();
      document.execCommand('copy');
      alert('已複製到剪貼簿！');
    }

    // 自動產生民國日期
    function getTaiwanDate() {
      const today = new Date();
      const year = today.getFullYear() - 1911;
      const month = String(today.getMonth() + 1).padStart(2, '0');
      const day = String(today.getDate()).padStart(2, '0');
      return `${year}/${month}/${day}`;
    }
    document.getElementById('date').value = getTaiwanDate();
  </script>
</body>
</html>
