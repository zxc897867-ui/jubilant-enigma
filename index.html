<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>房屋資訊自動生成器</title>
  <style>
    body { font-family: "微軟正黑體", Arial, sans-serif; margin: 30px; }
    label { display: block; margin: 8px 0 2px; }
    input[type="text"], select, textarea { box-sizing: border-box; }
    input[type="radio"], input[type="checkbox"] { width: auto; margin-right: 4px; vertical-align: middle; }
    .radio-group label, .checkbox-group label { margin-right: 16px; font-weight: normal; display: inline-block; }
    .radio-group input[type="text"], .checkbox-group input[type="text"] {
      min-width: 120px;
      width: auto;
      max-width: 60vw;
      margin-left: 4px;
      display: none;
      vertical-align: middle;
      transition: width 0.2s;
    }
    .auto-grow {
      min-width: 120px;
      width: auto;
      max-width: 60vw;
      transition: width 0.2s;
    }
    .square-textarea {
      width: 200px;
      height: 200px;
      resize: both;
      font-size: 16px;
      box-sizing: border-box;
      display: block;
    }
    .flex-row { display: flex; align-items: center; gap: 8px; }
    .small-input { width: 30px; text-align: center; }
    input[type="radio"]:checked, input[type="checkbox"]:checked { accent-color: orange; }
    textarea { margin-top: 10px; width: 100%; font-size: 18px; }
    button { margin: 10px 5px 0 0; padding: 8px 16px; }
    .row { display: flex; gap: 10px; }
    .row label, .row input { flex: 1; }
  </style>
</head>
<body>
  <h2>房屋資訊自動生成器</h2>
  <form id="houseForm" autocomplete="off">
    <div class="row">
      <label>日期（自動產生）</label>
      <input name="date" id="date" readonly>
    </div>
    <!-- 可否廣告 -->
    <label>可否廣告：
      <span class="radio-group">
        <label><input type="radio" name="ad" value="可刊登">可刊登</label>
        <input type="text" id="ad_yes_text" name="ad_yes_text" class="auto-grow" placeholder="補充說明" style="display:none;" size="8">
        <label><input type="radio" name="ad" value="不可刊登591可刊登其他平台">不可刊登591可刊登其他平台</label>
        <input type="text" id="ad_no_text" name="ad_no_text" class="auto-grow" placeholder="補充說明" style="display:none;" size="8">
        <label><input type="radio" name="ad" value="不可刊登">不可刊登</label>
        <input type="text" id="ad_no2_text" name="ad_no2_text" class="auto-grow" placeholder="補充說明" style="display:none;" size="8">
      </span>
    </label>
    <!-- 可否簽委托書 -->
    <label>可否簽委托書：
      <span class="radio-group">
        <label><input type="radio" name="sign" value="可(已簽)">可(已簽)</label>
        <input type="text" id="sign_yes_text" name="sign_yes_text" class="auto-grow" placeholder="補充說明" style="display:none;" size="8">
        <label><input type="radio" name="sign" value="可(可補簽)">可(可補簽)</label>
        <input type="text" id="sign_yes2_text" name="sign_yes2_text" class="auto-grow" placeholder="補充說明" style="display:none;" size="8">
        <label><input type="radio" name="sign" value="不可(可上架廣告)">不可(可上架廣告)</label>
        <input type="text" id="sign_no_text" name="sign_no_text" class="auto-grow" placeholder="補充說明" style="display:none;" size="8">
      </span>
    </label>
    <!-- 地址 -->
    <label>地址(詳細地址及樓層如為頂加特別註記):<input name="address" class="auto-grow" required></label>
    <!-- 頂加是否為民國84年前增建 -->
    <label>頂加是否為民國84年前增建如果是頂加需詢問房東是否為84年前增建，不是的話會有被拆除的風險 :
      <span class="radio-group">
        <label><input type="radio" name="top" value="是">是</label>
        <label><input type="radio" name="top" value="否">否</label>
      </span>
    </label>
    <!-- 房號 -->
    <label>房號 如為分套/雅房（會有房號、或大門到房間門的路徑怎麼走）方便後續行銷人員帶看 :<input name="room" class="auto-grow" required></label>
    <!-- 總樓層 -->
    <label>總樓層 所在樓層/總樓層數 :<input name="floor" class="auto-grow" required></label>
    <!-- 建物型態 -->
    <label>建物型態 前面為房間型態（分套、獨套、雅房）/後面為大樓的型態（公寓、電梯大樓、透天厝）:<input name="type" class="auto-grow" required></label>
    <!-- 坪數 -->
    <label>坪數 房內坪數（如為獨立套房/整層需調閱謄本） 頂加不用調:<input name="area" class="auto-grow" required></label>
    <!-- 格局 -->
    <label>格局: 
      <span class="flex-row">
        <input type="text" name="layout_room" class="small-input" maxlength="2" placeholder="房">
        房
        <input type="text" name="layout_living" class="small-input" maxlength="2" placeholder="廳">
        廳
        <input type="text" name="layout_bath" class="small-input" maxlength="2" placeholder="衛浴">
        衛浴
        <input type="text" name="layout_kitchen" class="small-input" maxlength="2" placeholder="廚房">
        廚房
        <input type="text" name="layout_balcony" class="small-input" maxlength="2" placeholder="陽台">
        陽台
        <label><input type="checkbox" name="layout_option" value="開放式">開放式</label>
        <label><input type="checkbox" name="layout_option" value="樓中樓">樓中樓</label>
      </span>
    </label>
    <!-- 租金 -->
    <label>租金：<input name="rent" class="auto-grow" required></label>
    <!-- 管理費 -->
    <label>管理費 有無管理費用（若有請註記包含哪些費用ex:水費、瓦斯費、第四台費用、網路費用、垃圾代收) :<input name="fee" class="auto-grow" required></label>
    <!-- 底價 -->
    <label>底價：<input name="base" class="auto-grow" required></label>
    <!-- 報稅 -->
    <label>報稅 (可否讓租客申請報稅/公證) :
      <span class="radio-group">
        <label><input type="radio" name="tax" value="可">可</label>
        <input type="text" id="tax_yes_text" name="tax_yes_text" class="auto-grow" placeholder="補充說明" style="display:none;" size="8">
        <label><input type="radio" name="tax" value="不可">不可</label>
      </span>
    </label>
    <!-- 租補 -->
    <label>租補：
      <span class="radio-group">
        <label><input type="radio" name="subsidy" value="可">可</label>
        <input type="text" id="subsidy_yes_text" name="subsidy_yes_text" class="auto-grow" placeholder="補充說明" style="display:none;" size="8">
        <label><input type="radio" name="subsidy" value="否">否</label>
        <label><input type="radio" name="subsidy" value="其他" id="subsidy_other_radio">其他</label>
        <input type="text" id="subsidy_other_text" name="subsidy_other" placeholder="請輸入其他內容" style="display:none;" size="8">
      </span>
    </label>
    <!-- 入籍 -->
    <label>入籍：
      <span class="radio-group">
        <label><input type="radio" name="register" value="可">可</label>
        <input type="text" id="register_yes_text" name="register_yes_text" class="auto-grow" placeholder="補充說明" style="display:none;" size="8">
        <label><input type="radio" name="register" value="不可">不可</label>
        <label><input type="radio" name="register" value="其他" id="register_other_radio">其他</label>
        <input type="text" id="register_other_text" name="register_other" placeholder="請輸入其他內容" style="display:none;" size="8">
      </span>
    </label>
    <!-- 寵物 -->
    <label>寵物：
      <span class="checkbox-group">
        <label><input type="checkbox" name="pet" value="可寵">可寵</label>
        <label><input type="checkbox" name="pet" value="可寵(可談)">可寵(可談)</label>
        <label><input type="checkbox" name="pet" value="可貓">可貓</label>
        <label><input type="checkbox" name="pet" value="可狗">可狗</label>
        <label><input type="checkbox" name="pet" value="其他" id="pet_other_checkbox">其他</label>
        <input type="text" id="pet_other_text" name="pet_other" placeholder="請輸入其他內容" style="display:none;" size="8">
      </span>
    </label>
    <!-- 垃圾代收 -->
    <label>垃圾代收有無垃圾袋收，有的話是否需要專用垃圾袋：
      <span class="radio-group">
        <label><input type="radio" name="garbage" value="有">有</label>
        <input type="text" id="garbage_yes_text" name="garbage_yes_text" class="auto-grow" placeholder="補充說明" style="display:none;" size="8">
        <label><input type="radio" name="garbage" value="無">無</label>
        <label><input type="radio" name="garbage" value="其他" id="garbage_other_radio">其他</label>
        <input type="text" id="garbage_other_text" name="garbage_other" placeholder="請輸入其他內容" style="display:none;" size="8">
      </span>
    </label>
    <!-- 停車位 -->
    <label>停車位：
      <span class="radio-group">
        <label><input type="radio" name="parking" value="有">有</label>
        <label><input type="radio" name="parking" value="無">無</label>
        <label><input type="radio" name="parking" value="其他" id="parking_other_radio">其他</label>
        <input type="text" id="parking_other_text" name="parking_other" placeholder="請輸入其他內容" style="display:none;" size="8">
      </span>
    </label>
    <!-- 公設 -->
    <label>公設：<input name="public" class="auto-grow" placeholder="請填寫公設內容"></label>
    <label>電費$/度：<input name="electric" class="auto-grow" required></label>
    <label>水費：<input name="water" class="auto-grow" required></label>
    <!-- 瓦斯 -->
    <label>瓦斯 有無瓦斯爐（是否能開火、還是不能用明火，可用電磁爐，請另外標註天然瓦斯或是瓦斯桶，瓦斯桶不可勾天然瓦斯) :<input name="gas" class="auto-grow" required></label>
    <label>鄰近交通(站點/分鐘)：<input name="traffic" class="auto-grow" required></label>
    <!-- 帶看方式 -->
    <label>帶看方式 房東貴姓、聯絡電話（註記清楚方便後續行銷人員帶看）：<input name="show" class="auto-grow" required></label>
    <!-- 附加設備正方形 -->
    <label>附加設備：<textarea name="equip" class="square-textarea" required></textarea></label>
    <label>注意事項(生活機能、東服等補充)：<input name="note" class="auto-grow" required></label>
    <label>開發：<input name="dev" class="auto-grow" required></label>
    <button type="button" onclick="generate()">產生格式</button>
    <button type="button" onclick="copyText()">複製內容</button>
  </form>
  <textarea id="output" readonly placeholder="這裡會自動產生格式內容" oninput="autoGrow(this)"></textarea>

  <script>
    // 自動產生民國日期
    function getTaiwanDate() {
      const today = new Date();
      const year = today.getFullYear() - 1911;
      const month = String(today.getMonth() + 1).padStart(2, '0');
      const day = String(today.getDate()).padStart(2, '0');
      return `${year}/${month}/${day}`;
    }
    document.getElementById('date').value = getTaiwanDate();

    // 可否廣告、可否簽委托書、租補、報稅、入籍、垃圾代收、公設的補充說明顯示
    function toggleInput(radioName, yesId, noId, yes2Id, no2Id, otherId) {
      document.querySelectorAll(`input[name="${radioName}"]`).forEach(function(radio) {
        radio.addEventListener('change', function() {
          if (yesId) document.getElementById(yesId).style.display = (radio.value === "可刊登" || radio.value === "可(已簽)" || radio.value === "可" || radio.value === "可(可補簽)") && radio.checked ? 'inline-block' : 'none';
          if (yes2Id) document.getElementById(yes2Id).style.display = (radio.value === "可(可補簽)") && radio.checked ? 'inline-block' : 'none';
          if (noId) document.getElementById(noId).style.display = (radio.value === "不可刊登591可刊登其他平台" || radio.value === "不可(可上架廣告)" || radio.value === "不可") && radio.checked ? 'inline-block' : 'none';
          if (no2Id) document.getElementById(no2Id).style.display = (radio.value === "不可刊登") && radio.checked ? 'inline-block' : 'none';
          if (otherId) document.getElementById(otherId).style.display = (radio.value === "其他" && radio.checked) ? 'inline-block' : 'none';
          // 清空未顯示的欄位
          if (yesId && document.getElementById(yesId).style.display === 'none') document.getElementById(yesId).value = '';
          if (yes2Id && document.getElementById(yes2Id).style.display === 'none') document.getElementById(yes2Id).value = '';
          if (noId && document.getElementById(noId).style.display === 'none') document.getElementById(noId).value = '';
          if (no2Id && document.getElementById(no2Id).style.display === 'none') document.getElementById(no2Id).value = '';
          if (otherId && document.getElementById(otherId).style.display === 'none') document.getElementById(otherId).value = '';
        });
      });
    }
    toggleInput('ad', 'ad_yes_text', 'ad_no_text', null, 'ad_no2_text');
    toggleInput('sign', 'sign_yes_text', 'sign_no_text', 'sign_yes2_text');
    toggleInput('tax', 'tax_yes_text', null);
    toggleInput('subsidy', 'subsidy_yes_text', null, null, null, 'subsidy_other_text');
    toggleInput('register', 'register_yes_text', null, null, null, 'register_other_text');
    toggleInput('garbage', 'garbage_yes_text', null, null, null, 'garbage_other_text');

    // 其他 radio group 的「其他」欄位顯示
    const radioFields = [
      'top', 'parking'
    ];
    radioFields.forEach(function(field) {
      const otherRadio = document.getElementById(`${field}_other_radio`);
      const otherText = document.getElementById(`${field}_other_text`);
      if (otherText) otherText.style.display = 'none';
      document.querySelectorAll(`input[name="${field}"]`).forEach(function(radio) {
        radio.addEventListener('change', function() {
          if (otherRadio && otherText) {
            if (otherRadio.checked) {
              otherText.style.display = 'inline-block';
              otherText.focus();
              adjustInputWidth(otherText);
            } else {
              otherText.style.display = 'none';
              otherText.value = '';
            }
          }
        });
      });
    });

    // 寵物複選的其他
    const petOtherCheckbox = document.getElementById('pet_other_checkbox');
    const petOtherText = document.getElementById('pet_other_text');
    if (petOtherCheckbox && petOtherText) {
      petOtherCheckbox.addEventListener('change', function() {
        if (petOtherCheckbox.checked) {
          petOtherText.style.display = 'inline-block';
          petOtherText.focus();
          adjustInputWidth(petOtherText);
        } else {
          petOtherText.style.display = 'none';
          petOtherText.value = '';
        }
      });
    }

    // 讓所有 .auto-grow input 根據內容自動變長
    function adjustInputWidth(input) {
      let span = document.getElementById('width-tester');
      if (!span) {
        span = document.createElement('span');
        span.id = 'width-tester';
        span.style.visibility = 'hidden';
        span.style.position = 'absolute';
        span.style.whiteSpace = 'pre';
        span.style.font = window.getComputedStyle(input).font;
        document.body.appendChild(span);
      }
      span.textContent = input.value || input.placeholder || '';
      input.style.width = Math.max(120, span.offsetWidth + 20) + 'px';
    }
    document.querySelectorAll('.auto-grow').forEach(function(input) {
      input.addEventListener('input', function() {
        adjustInputWidth(this);
      });
      adjustInputWidth(input);
    });
    document.querySelectorAll('.radio-group input[type="text"], .checkbox-group input[type="text"]').forEach(function(input) {
      input.addEventListener('input', function() {
        adjustInputWidth(this);
      });
    });

    // 讓產生格式的 textarea 自動變高
    function autoGrow(element) {
      element.style.height = "5px";
      element.style.height = (element.scrollHeight) + "px";
    }

    // 取得 radio 欄位值（含補充說明/其他）
    function getRadioValue(field, yesId, noId, yes2Id, no2Id, otherId) {
      const checked = document.querySelector(`input[name="${field}"]:checked`);
      if (!checked) return '';
      let result = checked.value;
      if (field === 'ad') {
        if (checked.value === '可刊登' && yesId) {
          const txt = document.getElementById(yesId).value;
          if (txt) result += `（${txt}）`;
        }
        if (checked.value === '不可刊登591可刊登其他平台' && noId) {
          const txt = document.getElementById(noId).value;
          if (txt) result += `（${txt}）`;
        }
        if (checked.value === '不可刊登' && no2Id) {
          const txt = document.getElementById(no2Id).value;
          if (txt) result += `（${txt}）`;
        }
      } else if (field === 'sign') {
        if (checked.value === '可(已簽)' && yesId) {
          const txt = document.getElementById(yesId).value;
          if (txt) result += `（${txt}）`;
        }
        if (checked.value === '可(可補簽)' && yes2Id) {
          const txt = document.getElementById(yes2Id).value;
          if (txt) result += `（${txt}）`;
        }
        if (checked.value === '不可(可上架廣告)' && noId) {
          const txt = document.getElementById(noId).value;
          if (txt) result += `（${txt}）`;
        }
      } else if (field === 'tax') {
        if (checked.value === '可' && yesId) {
          const txt = document.getElementById(yesId).value;
          if (txt) result += `（${txt}）`;
        }
      } else if (field === 'subsidy') {
        if (checked.value === '可' && yesId) {
          const txt = document.getElementById(yesId).value;
          if (txt) result += `（${txt}）`;
        }
        if (checked.value === '其他' && otherId) {
          const txt = document.getElementById(otherId).value;
          if (txt) result = txt ? `其他（${txt}）` : '其他';
        }
      } else if (field === 'register') {
        if (checked.value === '可' && yesId) {
          const txt = document.getElementById(yesId).value;
          if (txt) result += `（${txt}）`;
        }
        if (checked.value === '其他' && otherId) {
          const txt = document.getElementById(otherId).value;
          if (txt) result = txt ? `其他（${txt}）` : '其他';
        }
      } else if (field === 'garbage') {
        if (checked.value === '有' && yesId) {
          const txt = document.getElementById(yesId).value;
          if (txt) result += `（${txt}）`;
        }
        if (checked.value === '其他' && otherId) {
          const txt = document.getElementById(otherId).value;
          if (txt) result = txt ? `其他（${txt}）` : '其他';
        }
      } else {
        if (checked.value === '其他' && otherId) {
          const txt = document.getElementById(otherId).value;
          if (txt) result = txt;
        }
      }
      return result;
    }

    // 取得寵物複選值
    function getPetValue() {
      let arr = [];
      document.querySelectorAll('input[name="pet"]:checked').forEach(function(cb) {
        if (cb.value === '其他') {
          const txt = document.getElementById('pet_other_text').value;
          if (txt) arr.push(txt);
          else arr.push('其他');
        } else {
          arr.push(cb.value);
        }
      });
      return arr.join('、');
    }

    // 取得格局
    function getLayoutValue() {
      const room = document.querySelector('input[name="layout_room"]').value || '0';
      const living = document.querySelector('input[name="layout_living"]').value || '0';
      const bath = document.querySelector('input[name="layout_bath"]').value || '0';
      const kitchen = document.querySelector('input[name="layout_kitchen"]').value || '0';
      const balcony = document.querySelector('input[name="layout_balcony"]').value || '0';
      let layout = `房${room} 廳${living} 衛浴${bath} 廚房${kitchen} 陽台${balcony}`;
      let options = [];
      document.querySelectorAll('input[name="layout_option"]:checked').forEach(function(cb) {
        options.push(cb.value);
      });
      if (options.length) layout += ' ' + options.join('、');
      return layout;
    }

    // 產生格式內容
    function generate() {
      const form = document.getElementById('houseForm');
      const data = new FormData(form);
      let output =
        `日期：${data.get('date')}\n\n` +
        `可否廣告：${getRadioValue('ad', 'ad_yes_text', 'ad_no_text', null, 'ad_no2_text')}\n\n` +
        `可否簽委托書：${getRadioValue('sign', 'sign_yes_text', 'sign_no_text', 'sign_yes2_text')}\n\n` +
        `地址(詳細地址及樓層如為頂加特別註記):${data.get('address')}\n\n` +
        `頂加是否為民國84年前增建如果是頂加需詢問房東是否為84年前增建，不是的話會有被拆除的風險 :${getRadioValue('top')}\n\n` +
        `房號 如為分套/雅房（會有房號、或大門到房間門的路徑怎麼走）方便後續行銷人員帶看 :${data.get('room')}\n\n` +
        `總樓層 所在樓層/總樓層數 :${data.get('floor')}\n\n` +
        `建物型態 前面為房間型態（分套、獨套、雅房）/後面為大樓的型態（公寓、電梯大樓、透天厝）:${data.get('type')}\n\n` +
        `坪數 房內坪數（如為獨立套房/整層需調閱謄本） 頂加不用調:${data.get('area')}\n\n` +
        `格局: ${getLayoutValue()}\n\n` +
        `租金：${data.get('rent')}\n\n` +
        `管理費 有無管理費用（若有請註記包含哪些費用ex:水費、瓦斯費、第四台費用、網路費用、垃圾代收) :${data.get('fee')}\n\n` +
        `底價：${data.get('base')}\n\n` +
        `報稅 (可否讓租客申請報稅/公證) :${getRadioValue('tax', 'tax_yes_text')}\n\n` +
        `租補：${getRadioValue('subsidy', 'subsidy_yes_text', null, null, null, 'subsidy_other_text')}\n\n` +
        `入籍：${getRadioValue('register', 'register_yes_text', null, null, null, 'register_other_text')}\n\n` +
        `寵物：${getPetValue()}\n\n` +
        `垃圾代收有無垃圾袋收，有的話是否需要專用垃圾袋：${getRadioValue('garbage', 'garbage_yes_text', null, null, null, 'garbage_other_text')}\n\n` +
        `停車位：${getRadioValue('parking', null, null, null, null, 'parking_other_text')}\n\n` +
        `公設：${data.get('public')}\n\n` +
        `電費$/度：${data.get('electric')}\n\n` +
        `水費：${data.get('water')}\n\n` +
        `瓦斯 有無瓦斯爐（是否能開火、還是不能用明火，可用電磁爐，請另外標註天然瓦斯或是瓦斯桶，瓦斯桶不可勾天然瓦斯) :${data.get('gas')}\n\n` +
        `鄰近交通(站點/分鐘)：${data.get('traffic')}\n\n` +
        `帶看方式 房東貴姓、聯絡電話（註記清楚方便後續行銷人員帶看）：${data.get('show')}\n\n` +
        `附加設備：${data.get('equip')}\n\n` +
        `注意事項(生活機能、東服等補充)：${data.get('note')}\n\n` +
        `開發：${data.get('dev')}`;
      document.getElementById('output').value = output;
      autoGrow(document.getElementById('output'));
    }

    // 複製內容到剪貼簿
    function copyText() {
      const output = document.getElementById('output');
      output.select();
      document.execCommand('copy');
      alert('已複製到剪貼簿！');
    }
  </script>
</body>
</html>
